version: '3.9'
services:
  internvl2-8b:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        GIT_DOMAIN: huggingface.co
        GIT_ORG: OpenGVLab
        GIT_REPO: InternVL2-8B
        GIT_BRANCH: main
        DIR: internvl2-8b
        # pass through env vars to docker build
        DOCKER_USER: $DOCKER_USER
        HF_TOKEN: $HF_TOKEN
        USERNAME: $USER
    shm_size: '16gb'
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [ gpu ]
    image: open_vlm_caption_internvl2-8b
    container_name: open_vlm_caption_internvl2-8b
    volumes:
      - ./data:/data
    stdin_open: true
    tty: true
  ovis1.6-gemma2-9b:
      build:
        context: .
        dockerfile: Dockerfile
        args:
          GIT_DOMAIN: github.com
          GIT_ORG: AIDC-AI
          GIT_REPO: Ovis
          GIT_BRANCH: main
          DIR: ovis1.6-gemma2-9b
          DISABLE_REPOSITORY_DEPENDENCIES: 1
          # pass through env vars to docker build
          DOCKER_USER: $DOCKER_USER
          HF_TOKEN: $HF_TOKEN
          USERNAME: $USER
      shm_size: '16gb'
      deploy:
        resources:
          reservations:
            devices:
              - driver: nvidia
                count: all
                capabilities: [ gpu ]
      image: open_vlm_caption_ovis1.6-gemma2-9b
      container_name: open_vlm_caption_ovis1.6-gemma2-9b
      volumes:
        - ./data:/data
      stdin_open: true
      tty: true
      
  instructblip-vicuna-7b:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        GIT_DOMAIN: huggingface.co
        GIT_ORG: Salesforce
        GIT_REPO: instructblip-vicuna-7b
        GIT_BRANCH: main
        DIR: instructblip-vicuna-7b
        # pass through env vars to docker build
        DOCKER_USER: $DOCKER_USER
        HF_TOKEN: $HF_TOKEN
        USERNAME: $USER
    shm_size: '16gb'
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [ gpu ]
    image: open_vlm_caption_instructblip-vicuna-7b
    container_name: open_vlm_caption_instructblip-vicuna-7b
    volumes:
      - ./data:/data
    stdin_open: true
    tty: true
  salesforce_blip2:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        GIT_DOMAIN: huggingface.co
        GIT_ORG: Salesforce
        GIT_REPO: blip2-opt-6.7b-coco
        GIT_BRANCH: main
        DIR: Salesforce/blip2
        # pass through env vars to docker build
        DOCKER_USER: $DOCKER_USER
        HF_TOKEN: $HF_TOKEN
        USERNAME: $USER
    shm_size: '16gb'
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [ gpu ]
    image: open_vlm_caption_salesforce_blip2
    container_name: open_vlm_caption_salesforce_blip2
    volumes:
      - ./data:/data
    stdin_open: true
    tty: true
  
